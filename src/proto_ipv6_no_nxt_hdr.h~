/*
 * netsniff-ng - the packet sniffing beast
 * Copyright 2012 Markus Amend <markus@netsniff-ng.org>
 * Subject to the GPL, version 2.
 *
 * IPv6 No Next Header described in RFC2460
 */

#ifndef PROTO_IPV6_NO_NXT_HDR_H
#define PROTO_IPV6_NO_NXT_HDR_H

#include <stdio.h>
#include <stdint.h>
#include <netinet/in.h>    /* for ntohs() */

#include "proto_struct.h"
#include "dissector_eth.h"

static inline void no_next_header(struct pkt_buff *pkt)
{
	(*off) = 0;
	(*key) = 0;
	(*table) = NULL;
	pkt_set_proto(pkt, &eth_lay3, routing->h_next_header);
}

struct protocol ipv6_no_next_header_ops = {
	.key = 0x3B,
	.print_full = no_next_header,
	.print_less = no_next_header,
};

#endif /* PROTO_IPV6_NO_NXT_HDR_H */
